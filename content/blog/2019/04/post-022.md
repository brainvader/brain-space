+++
title = 'ソフトウェア設計用語集'
description =  'ソフトウェア設計における用語をまとめる'
date = 2019-04-27T12:10:04Z

[taxonomies]
categories = ["programming"]
tags = ["Software Design"]
+++

# ソフトウェア設計用語集

## 改訂情報

+ 2019-04-27

## 用語

+ DAO (Data Access Object)とリポジトリ
+ DTO (Data Transfer Object)とドメイン・モデル
+ ドメイン・モデル貧血症
+ トランザクション・スクリプト
+ Active Record
+ O/Rマッパー
+ MVC

## DAOとリポジトリ

　データ・アクセスといってもデータの永続化方法は様々です. 同じRDMSでも微妙に書き方が違ったり利用するバージョンなども関係してきます. これを逐一書くのはおかしいということは誰でも気づくので抽象化します. これにより提供されているドライバーの違いなどを気にせずデータを取得に集中できます. DAOはこのためのものです. リポジトリも同じような役割を果たしますが, コンセプトが微妙に違うようです.[<sup>1</sup>](#com-1)

　リポジトリの目的はデータ・アクセスの実装を隠すことではなく, ドメイン・オブジェクトを管理することです. よってリポジトリがその内部でDAOを利用することも考えられます. DAOはデザイン・パターンであり, 異種のデータ・ソースに共通のインターフェースを提供するだけです. DAOは取得したレコード(リレーショナル・データベースの場合)をオブジェクトとして返します. 一方リポジトリを介する場合は, ドメイン・オブジェクトとなります. あくまで概念的な話ですが, 依拠しているコンテクストが違ってくるようです.

## DTOとドメイン・モデル

　DTOは構造体と思えばいいと思います. つまりデータとそのアクセサだけからなるオブジェクトです. 目的は名前そのままでデータの転送です. 例えばUserのデータをやり取りするときはfirst_name, last_name, address...という感じで別々に引数として渡すのは面倒です. 新しいデータ型を定義してまとめてやるべきです. 一方ドメイン・モデルは振る舞いを持ちます. またデータへ直接アクセスすることは基本的にはできません. OOPがオブジェクト間のメッセージのやりとりで成り立つという原則に立ち返ると, 基本に忠実なオブジェクトとも言えます.

## ドメイン・モデル貧血症

　ドメイン・モデルはそれぞれ担う責務があります. そのために必要なデータと処理を集めたオブジェクとというわけです. しかしDTOや値オブジェクトのようにデータのやり取りを効率化するようなオブジェクトも存在します. これはオブジェクトというよりデータにすぎません. こうしたデータにすぎないオブジェクトをドメイン・モデル貧血症と呼んでいるようです. 問題はこのようなオブジェクトを作ってはいけないということではなく, これをドメイン・モデルとして運用することにあるようです.[<sup>2</sup>](#com-2)

## トランザクション・スクリプト

　ユースケース単位でビジネス・ルールを記述する手法のようです. ドメインが責務に応じてオブジェクトの単位を決めていたのに対して, 処理の流れを意識した書き方と言えるかもしれません.[<sup>3</sup>](#com-3)

>　たとえば「注文を登録する」「注文を変更する」「注文をキャンセルする」という３つのユースケースを考えてみましょう。この３つのユースケースは「注文」という共通の関心事についての異なるアクションです。「トランザクションスクリプト」では、「注文」に関するビジネスルール、判断・加工・計算のロジックは、３つのユースケースで重複して記述されます。

## Active Record

　Active RecordパターンはRuby on RailsやLaravelのEloquentで利用されているらしいです. [デザインパターンから見た
　Active Record](https://www.techscore.com/tech/Ruby/Rails/other/designpattern/1/)によると, 

+ クラスは1つのテーブルを表す
+ インスタンスはテーブルの1行を表す
+ クラス、インスタンスメソッドで関連するデータ処理を行う

　レコードが個々のインスタンスに結合されるデータで, クラスはレコードの集まりであるテーブルと一対一に対応するということのようです.

## O/Rマッパー

　Object/Relationマッパーのことで, オブジェクトとはOOPの文脈の話でリレーションはRDBのことです. データはRDBで管理されていますが, アプリ側ではOOPが使われています. この両者を上手く対応づけて捌くのがO/Rマッパーの仕組みのようです.


## MVC

　現在調査中!!

## 注釈
<a name="com-1"></a> 1. [リポジトリとDAOの住み分け方](http://blog.fukuchiharuki.me/entry/use-repository-and-dao-according-to-the-purpose)  
<a name="com-2"></a>2. [「ドメインモデル貧血症」を見かけたので、誤解しないように備忘録](https://hiroronn.hatenablog.jp/entry/20171026/1508975305)  
<a name="com-3"></a>3. [ドメインモデル中心のアーキテクチャ](https://devtab.jp/entry/internal/42)
